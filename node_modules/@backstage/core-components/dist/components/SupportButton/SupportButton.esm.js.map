{"version":3,"file":"SupportButton.esm.js","sources":["../../../src/components/SupportButton/SupportButton.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApp } from '@backstage/core-plugin-api';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport MenuList from '@material-ui/core/MenuList';\nimport Popover from '@material-ui/core/Popover';\nimport { Theme, makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport React, { MouseEventHandler, useState } from 'react';\nimport { SupportItem, SupportItemLink, useSupportConfig } from '../../hooks';\nimport { HelpIcon } from '../../icons';\nimport { Link } from '../Link';\nimport { coreComponentsTranslationRef } from '../../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\ntype SupportButtonProps = {\n  title?: string;\n  items?: SupportItem[];\n  children?: React.ReactNode;\n};\n\nexport type SupportButtonClassKey = 'popoverList';\n\nconst useStyles = makeStyles(\n  {\n    popoverList: {\n      minWidth: 260,\n      maxWidth: 400,\n    },\n    menuItem: {\n      whiteSpace: 'normal',\n    },\n  },\n  { name: 'BackstageSupportButton' },\n);\n\nconst SupportIcon = ({ icon }: { icon: string | undefined }) => {\n  const app = useApp();\n  const Icon = icon ? app.getSystemIcon(icon) ?? HelpIcon : HelpIcon;\n  return <Icon />;\n};\n\nconst SupportLink = ({ link }: { link: SupportItemLink }) => (\n  <Link to={link.url}>{link.title ?? link.url}</Link>\n);\n\nconst SupportListItem = ({ item }: { item: SupportItem }) => {\n  return (\n    <MenuItem>\n      <ListItemIcon>\n        <SupportIcon icon={item.icon} />\n      </ListItemIcon>\n      <ListItemText\n        primary={item.title}\n        secondary={item.links?.reduce<React.ReactNode[]>(\n          (prev, link, idx) => [\n            ...prev,\n            idx > 0 && <br key={idx} />,\n            <SupportLink link={link} key={link.url} />,\n          ],\n          [],\n        )}\n      />\n    </MenuItem>\n  );\n};\n\nexport function SupportButton(props: SupportButtonProps) {\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n  const { title, items, children } = props;\n  const { items: configItems } = useSupportConfig();\n\n  const [popoverOpen, setPopoverOpen] = useState(false);\n  const [anchorEl, setAnchorEl] = useState<Element | null>(null);\n  const classes = useStyles();\n  const isSmallScreen = useMediaQuery<Theme>(theme =>\n    theme.breakpoints.down('sm'),\n  );\n\n  const onClickHandler: MouseEventHandler = event => {\n    setAnchorEl(event.currentTarget);\n    setPopoverOpen(true);\n  };\n\n  const popoverCloseHandler = () => {\n    setPopoverOpen(false);\n  };\n\n  return (\n    <>\n      <Box display=\"flex\" ml={1}>\n        {isSmallScreen ? (\n          <IconButton\n            color=\"primary\"\n            size=\"small\"\n            onClick={onClickHandler}\n            data-testid=\"support-button\"\n            aria-label=\"Support\"\n          >\n            <HelpIcon />\n          </IconButton>\n        ) : (\n          <Button\n            data-testid=\"support-button\"\n            aria-label=\"Support\"\n            color=\"primary\"\n            onClick={onClickHandler}\n            startIcon={<HelpIcon />}\n          >\n            {t('supportButton.title')}\n          </Button>\n        )}\n      </Box>\n      <Popover\n        data-testid=\"support-button-popover\"\n        open={popoverOpen}\n        anchorEl={anchorEl}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n        onClose={popoverCloseHandler}\n      >\n        <MenuList\n          className={classes.popoverList}\n          autoFocusItem={Boolean(anchorEl)}\n        >\n          {title && (\n            <MenuItem alignItems=\"flex-start\" className={classes.menuItem}>\n              <Typography variant=\"subtitle1\">{title}</Typography>\n            </MenuItem>\n          )}\n          {React.Children.map(children, (child, i) => (\n            <MenuItem\n              alignItems=\"flex-start\"\n              key={`child-${i}`}\n              className={classes.menuItem}\n            >\n              {child}\n            </MenuItem>\n          ))}\n          {(items ?? configItems).map((item, i) => (\n            <SupportListItem item={item} key={`item-${i}`} />\n          ))}\n        </MenuList>\n        <DialogActions>\n          <Button\n            color=\"primary\"\n            onClick={popoverCloseHandler}\n            aria-label=\"Close\"\n          >\n            {t('supportButton.close')}\n          </Button>\n        </DialogActions>\n      </Popover>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}